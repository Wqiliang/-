<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="wph.css" />
    <link rel="stylesheet" href="./font/iconfont.css">

</head>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.js"></script>
<script src="js/fy.js"></script>
<body>
    <div class="navtop">
        <div class="nav-top">
            <div class="city"><a href="#">石家庄</a></div>
            <ul>
                <li><a href="login.html">请登录</a></li>
                <li><a href="register.html">注册</a></li>
                <li><a href="#">签到有礼</a></li>
                <li><a href="#">我的订单</a></li>
                <li><a href="#">我的特卖</a></li>
                <li><a href="#">会员俱乐部</a>
                    <ul>
                        <li><a href="#">俱乐部首页</a></li>
                        <li><a href="#">唯品币兑换</a></li>

                    </ul>
                </li>
                <li><a href="#">客户服务</a></li>
                <li><a href="#">手机版</a></li>
                <li><a href="#">更多</a></li>
            </ul>

        </div>
    </div>
    <div class="lognav">
        <div class="log-nav">
            <a class="frist" href="#"><img src="img/logo.png"></a>
            <a class="log" href="#"><img src="img/log.jpg"></a>
            <a class="log" href="#"><img src="img/log1.jpg"></a>
            <a class="log" href="#"><img src="img/log2.jpg"></a>
            <div class="search">
                <input type="text" placeholder="女士羽绒服" />
                <a class="buttonsearch" class="iconfont" href="#">&#xe6e4;</a>


            </div>
            <div class="gwc">
                <span class="iconfont">&#xe60e;</span>
                <a href="#">
                    购物袋</a>
                <span class="gwright">0</span>

            </div>

        </div>
    </div>
    <div class="secondnav">
        <div class="second-nav">
            <div class="goleft">
                <a href="#">商品分类</a>
            </div>
            <ul class="goright">
                <li><a href="#">首页</a></li>
                <li><a href="#">最后疯抢</a></li>
                <li><a href="#">唯品快枪</a></li>
                <li><a href="#">女装</a></li>
                <li><a href="#">母婴</a></li>
                <li><a href="#">家电</a></li>
                <li><a href="#">国际</a></li>
                <li><a href="#">美妆</a></li>
                <li><a href="#">鞋包</a></li>
                <li><a href="#">男装</a></li>
                <li><a href="#">预告</a></li>
                <li><a href="#">更多</a></li>
            </ul>

        </div>
    </div>


    <div class="banner-container">
        <div class="banner-warp">
            <div class="bannerbutton">
                <button class="left">&lt</button>
                <button class="right">&gt</button>
            </div>
            <div class="click">
                <span class="active"></span>
                <span></span>
                <span></span>
            </div>
            <div class="bannerwap">
                <div class="bannerbox">
                    <img src="img/15490152987275.jpg">
                </div>
                <div class="bannerbox">
                    <img src="img/ias_154650506610601_570x273_90.jpg">
                </div>
                <div class="bannerbox">
                    <img src="img/ias_154803675156094_570x273_901.jpg">
                </div>
                <div class="bannerbox">
                    <img src="img/15490152987275.jpg">
                </div>
            </div>
        </div>

    </div>

    <div class="main-container">
        <div class="protitle">
            <div class="imgbox">
                <img src="img/today_DDp.png" />
            </div>
        </div>
        <div class="stair">
        <div class="nvzhuang">
            <p>
                <img src="img/woman_2ad.png">
                <a href="">全部女装品牌</a>

            </p>
        </div>
        <div class="itemwarp">
           
   </div>
</div>
 <div class="stair">
<div class="nvzhuang">
    <p>
        <img src="img/xie.png">
        <a href="">全部鞋包品牌</a>

    </p>
</div> 
<div class="itemwarp">

</div>
</div>
<div class="stair">
<div class="nvzhuang">
    <p>
        <img src="img/men_hhqx.png">
        <a href="">全部男装品牌</a>

    </p>
</div> 
<div class="itemwarp">

</div>
</div>
</div>
  
    


     <div class="floorwarp">
         <ul class="btn">
           <li><a class="active" href="#">女装</a></li>
           <li><a href="#">鞋包</a></li>
           <li><a href="#">男装</a></li>
           <li><a href="#">运动</a></li>
           <li><a href="#">饰品</a></li>
           <li><a href="#">美妆</a></li>
           <li><a href="#">母婴</a></li>
           <li><a href="#">居家</a></li>
           <li><a href="#">国际</a></li>
           <li><a href="#">生活</a></li>
           <li><a href="#">预告</a></li>
        </ul> 
    </div> 
    
    <script src="js/art-template.js"></script>
    <!-- <script type="text/html id="showgood">
        {{each list item }}
        <div class="showgood">
            <div class="showbox"> 
                <a href="#">
                    <img src={{item.brandImage.size1}}>
                </a>
                <div class="ms">
                    <span>珂莱蒂尔koradior-赢家集团品牌钜献女装专场</span>
                </div>
                <div class="lastms">
                    <span>
                        {{item.agio}}
                    </span>
                    <span>{{item.salesName}}</span>
                    <p>
                        <i class="iconfont">&#xe60e;</i>
                        <span>剩5天</span>
                    </p>
                </div>
            </div>


        </div>
        {{/each}} 
    </script>
        -->
        <script>
                // 轮播图js
               function Lbt() {
                   this.index = 0
                   this
                   this.left = document.querySelector(".left")
                   this.right = document.querySelector(".right")
                   this.bannerwap = document.querySelector(".bannerwap")
                   // console.log(this.bannerwap)
                   this.wapbanners = document.querySelector(".bannerwap").children
                   this.spans = document.querySelector(".click").children
                   //console.log(this.spans)
                   this.spans = Array.from(this.spans)
       
               }
               Lbt.prototype.int = function () {
                   this.event()
                   this.bannerwap.style.width = this.wapbanners.length * this.wapbanners[0].offsetWidth + "px"
                  
               }
               Lbt.prototype.event = function () {
                   this.left.addEventListener("click", this.banner_move.bind(this))
                   
                   this.right.addEventListener("click", this.bannermove.bind(this))
                   this.left.addEventListener("click", this.annimate.bind(this))
                   this.right.addEventListener("click", this.annimate.bind(this))
                   this.spans.forEach((item, index) => {
                       item.addEventListener("click", this.changeindex.bind(this, item, index))
                   })
               }
               Lbt.prototype.bannermove = function (){
                   if (this.index === this.wapbanners.length - 1) {
                       this.bannerwap.style.left = 0
                       this.index = 1
                   }
                   else {
                       this.index++
                   }
               }
               Lbt.prototype.banner_move = function () {
                   if (this.index === 0) {
                       this.bannerwap.style.left = -(this.wapbanners.length - 1) * this.wapbanners[0].offsetWidth + "px"
       
                       this.index = this.wapbanners.length - 2
                   }
                   else {
                       this.index--
                   }
       
               }
               Lbt.prototype.annimate = function () {
                   animate(this.bannerwap, "left", this.index * -1000)
                   this.spans.forEach((item, index) => {
                         item.className = ""
                   })
                   if(this.index == 3){
                       this.spans[0].className = "active"
                   }else{
                    this.spans[this.index].className = "active"
                   }
                   
                   
                   
               }
               Lbt.prototype.changeindex = function (item, index) {
                   this.spans.forEach((item, index) => {
                       item.className = ""
       
                   })
                   item.className = "active"
                   
                   this.index = index
       
                   animate(this.bannerwap, "left", this.index * -1000)
       
               }
             
               var lbt = new Lbt()
               lbt.int()
               // 数据渲染
               var url = "https://www.vip.com/ajax/getBrandRank.php?floorId=1&newDapLogic=1&warehouse=VIP_CD&channelId=0&sortType=1&areaCode=105103&pagecode=a&provinceName=%E4%BA%91%E5%8D%97%E7%9C%81&cityName=%E6%98%86%E6%98%8E%E5%B8%82&brandInfoExt%5Bfields%5D=displayEndtime%2CsalesNo%2CbrandImage%2CmobileImageOne%2Cagio%2CsalesName%2CbrandStoreSn%2CvendorSaleMessage%2CisSpecialBanner%2ChiddenEndTime%2CiconInfo%2Clink%2CbrandType%2Cpms_act_no%2CshowTimeFrom&brandInfoExt%5BstartIndex%5D=0&brandInfoExt%5Bnum%5D=36&preview=&token=&sell_time_from=&time_from=&_=1550119777708"
               var urltwo ="https://www.vip.com/ajax/getBrandRank.php?floorId=2&newDapLogic=1&warehouse=VIP_CD&channelId=0&sortType=1&areaCode=105103&pagecode=a&provinceName=%E4%BA%91%E5%8D%97%E7%9C%81&cityName=%E6%98%86%E6%98%8E%E5%B8%82&brandInfoExt%5Bfields%5D=displayEndtime%2CsalesNo%2CbrandImage%2CmobileImageOne%2Cagio%2CsalesName%2CbrandStoreSn%2CvendorSaleMessage%2CisSpecialBanner%2ChiddenEndTime%2CiconInfo%2Clink%2CbrandType%2Cpms_act_no%2CshowTimeFrom&brandInfoExt%5BstartIndex%5D=0&brandInfoExt%5Bnum%5D=36&preview=&token=&sell_time_from=&time_from=&_=1550139407741"
               var urlthr = "https://www.vip.com/ajax/getBrandRank.php?floorId=3&newDapLogic=1&warehouse=VIP_CD&channelId=0&sortType=1&areaCode=105103&pagecode=a&provinceName=%E4%BA%91%E5%8D%97%E7%9C%81&cityName=%E6%98%86%E6%98%8E%E5%B8%82&brandInfoExt%5Bfields%5D=displayEndtime%2CsalesNo%2CbrandImage%2CmobileImageOne%2Cagio%2CsalesName%2CbrandStoreSn%2CvendorSaleMessage%2CisSpecialBanner%2ChiddenEndTime%2CiconInfo%2Clink%2CbrandType%2Cpms_act_no%2CshowTimeFrom&brandInfoExt%5BstartIndex%5D=0&brandInfoExt%5Bnum%5D=36&preview=&token=&sell_time_from=&time_from=&_=1550147259992"
                var $itemwarp = $(".itemwarp")
                var $itemwarps = $(".main-container .itemwarp ")
                
               $.ajax(url,{
       
                       dataType : "jsonp"
                   })
                   .then(render)
                   function render(res){
                       var list = res.data.brandInfo
                       //console.log(list)
                       var html = ""
                       $.each(list,function(index,item){
                           html += `<div class="showgood">
                       <div class="showbox">
                           <a href="#">
                               <img src="${item.brandImage.size1}">
                           </a>
                           <div class="ms">
                               <span>珂莱蒂尔koradior-赢家集团品牌钜献女装专场</span>
                           </div>
                           <div class="lastms">
                               <span>
                                  
                                    ${item.agio}
                               </span>
                               <span>${item.salesName}</span>
                               <p>
                                   <i class="iconfont">&#xe60e;</i>
                                   <span>剩5天</span>
                               </p>
                           </div>
                       </div>
                   </div>
       
               </div>
                                      
           </div>
           </div>`
       
                       })
                            
                       
                       
                       // var html = template("showgood",{list:list});
       
                        $itemwarps.eq(0).html(html)
                    }
                       
                     
                   //     success :　function(res){
                   //         var list = res.data.brandInfo
                   //         console.log(list)
                   //         // console.log(res.data.brandInfo)
                   //         // $.each(res.data.brandInfo,function(index,item){
                   //         //     console.log(item)
                   //         // })
                   //     }
                   // })
                       
               
               $.ajax(urltwo,{
       
       dataType : "jsonp"
       })
       .then(renders)
       function renders(res){
       var list = res.data.brandInfo
       //console.log(list)
       var html = ""
       $.each(list,function(index,item){
           html += `<div class="showgood">
       <div class="showbox">
           <a href="#">
               <img src="${item.brandImage.size1}">
           </a>
           <div class="ms">
               <span>珂莱蒂尔koradior-赢家集团品牌钜献女装专场</span>
           </div>
           <div class="lastms">
               <span>
                  
                    ${item.agio}
               </span>
               <span>${item.salesName}</span>
               <p>
                   <i class="iconfont">&#xe60e;</i>
                   <span>剩5天</span>
               </p>
           </div>
       </div>
       </div>
       
       </div>
                      
       </div>
       </div>`
       
       })
            
       
       
       // var html = template("showgood",{list:list});
       
        $itemwarps.eq(1).html(html)
       }
       
       
       
       $.ajax(urlthr,{
       
       dataType : "jsonp"
       })
       .then(renderss)
       function renderss(res){
       var list = res.data.brandInfo
       //console.log(list)
       var html = ""
       $.each(list,function(index,item){
           console.log(item)
           html += `<div class="showgood">
       <div class="showbox">
           <a href="#">
               <img src="${item.brandImage.size1}">
           </a>
           <div class="ms">
               <span>珂莱蒂尔koradior-赢家集团品牌钜献女装专场</span>
           </div>
           <div class="lastms">
                ${item.agio}
              
               <span>${item.salesName}</span>
               <p>
                   <i class="iconfont">&#xe60e;</i>
                   <span>剩5天</span>
               </p>
           </div>
       </div>
       </div>
       
       </div>
                      
       </div>
       </div>`
       
       })
            
       
       
       // var html = template("showgood",{list:list});
       
        $itemwarps.eq(2).html(html)
       }
       //  楼梯js 楼层渲染了三个数据  分别是女装 装饰 和 男装
        function Stair(){
       
        }
        Object.assign(Stair.prototype,{
                init:function(){
                    this.distance = 400
                    this.floorwarp = $(".floorwarp")
                    this.btns = $(".btn li")
                   // console.log( this.floorwarp)
                   this.stairs = $(".stair")
                   // console.log(this.stairs)
                   this.stairsarray = []
                   for( var i = 0; i < this.stairs.length;i++){
                       var ele = this.stairs.eq(i)
                       this.stairsarray.push({
                            min:ele.offset().top,
                            max:ele.offset().top + ele.height()
                            
                       })
                        console.log(this.stairsarray)
                        console.log(ele.height(),ele.offset().top)
                   }
                    
                   this.event()
                 
                   
       
                },
                btnstoggle:function(){
                    var scrolltop = document.body.scrollTop || document.documentElement.scrollTop
                    if(scrolltop > this.distance){
                           this.floorwarp.show()
                    }
                   else{
                        this.floorwarp.hide()
                    }
       
                },
                event:function(){
                   $(window).on("scroll",this.btnstoggle.bind(this))
                   $(window).on("scroll",this.changeindex.bind(this))
                   this.btns.on("click",this.changescroll.bind(this))
                },
                changescroll:function(e){
                   var target = e.currentTarget
                          var index = $(target).index()
                          this.btns.removeClass("active").eq(index).addClass("active")
                          $("html,body").animate({
                              scrollTop : this.stairsarray[index].min
                          })
                           
                },
                changeindex:function(){
                    var scrolltop = document.body.scrollTop || document.documentElement.scrollTop
                            this.stairsarray.some((item,index)=>{
                                 if(scrolltop >= item.min && scrolltop <= item.max){
                                     this.btns.removeClass("active").eq(index).addClass("active")
                                     return true
                                 }
                            })
                }
       
                
        })
          var stair = new Stair()
          stair.init()
             
              
       
           </script>
         



















    
    
    
   
   


   



</body>

</html>